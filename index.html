<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover, user-scalable=no">
  <meta name="theme-color" content="#1E5B8A">
  <meta name="description" content="Interactive guide to 200+ murals from the SHINE Mural Festival in St. Petersburg, Florida">

  <!-- PWA -->
  <link rel="manifest" href="manifest.json">
  <link rel="icon" type="image/png" sizes="192x192" href="images/icons/icon-192.png">

  <!-- iOS PWA -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="SHINE">
  <link rel="apple-touch-icon" href="images/icons/icon-192.png">

  <!-- Fonts (CDN with SW caching for offline) -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&family=DM+Sans:wght@400;500;700&display=swap">

  <!-- App styles -->
  <link rel="stylesheet" href="css/app.css">

  <!-- Leaflet (map) -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <title>SHINE St. Pete</title>
</head>
<body>

  <!-- Offline indicator -->
  <div id="offline-banner" class="offline-banner" hidden>
    <span>Offline — using cached data</span>
  </div>

  <!-- Install prompt (Android/Chrome) -->
  <div id="install-prompt" class="install-prompt" hidden>
    <div class="install-prompt-inner">
      <span>Add SHINE to your home screen</span>
      <div class="install-prompt-actions">
        <button id="install-dismiss" class="btn-text">Not now</button>
        <button id="install-accept" class="btn-primary-sm">Install</button>
      </div>
    </div>
  </div>

  <!-- Install banner (iOS Safari) -->
  <div id="ios-install" class="install-prompt" hidden>
    <div class="install-prompt-inner">
      <span>To install: tap <svg style="display:inline;vertical-align:middle;margin:0 2px" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"/><polyline points="16 6 12 2 8 6"/><line x1="12" y1="2" x2="12" y2="15"/></svg> then "Add to Home Screen"</span>
      <div class="install-prompt-actions">
        <button id="ios-dismiss" class="btn-text">Got it</button>
      </div>
    </div>
  </div>

  <!-- App shell -->
  <div id="app">

    <!-- Header -->
    <header id="app-header" class="app-header">
      <div class="header-inner">
        <h1 class="header-title">SHINE</h1>
        <span class="header-subtitle">St. Pete Mural Guide</span>
      </div>
    </header>

    <!-- Search bar (visible on Explore tab) -->
    <div id="search-bar" class="search-bar" hidden>
      <div class="search-input-wrap">
        <svg class="search-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/>
        </svg>
        <input id="search-input" type="search" placeholder="Search artists, locations…" autocomplete="off">
      </div>
    </div>

    <!-- Year filter pills (visible on Explore tab) -->
    <div id="year-filters" class="year-filters" hidden>
      <div class="year-pills" id="year-pills">
        <!-- Populated by app.js -->
      </div>
    </div>

    <!-- Main content area — swapped by tab navigation -->
    <main id="main-content" class="main-content">
      <!-- Tab views rendered here by app.js -->
      <div id="view-explore" class="view" data-view="explore"></div>
      <div id="view-map" class="view" data-view="map" hidden></div>
      <div id="view-nearby" class="view" data-view="nearby" hidden></div>
      <div id="view-routes" class="view" data-view="routes" hidden></div>
      <div id="view-gallery" class="view" data-view="gallery" hidden></div>
    </main>

    <!-- Detail page (overlays main content) -->
    <div id="detail-page" class="detail-page" hidden>
      <button id="detail-back" class="detail-back" aria-label="Back">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="m15 18-6-6 6-6"/>
        </svg>
      </button>
      <div id="detail-content" class="detail-content">
        <!-- Populated by app.js -->
      </div>
    </div>

    <!-- Bottom tab bar -->
    <nav id="tab-bar" class="tab-bar">
      <button class="tab active" data-tab="explore" aria-label="Explore">
        <svg class="tab-icon" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/>
          <rect x="3" y="14" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/>
        </svg>
        <span class="tab-label">Explore</span>
      </button>
      <button class="tab" data-tab="map" aria-label="Map">
        <svg class="tab-icon" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="m3 7 6-3 6 3 6-3v13l-6 3-6-3-6 3Z"/><path d="m9 4v13"/><path d="m15 7v13"/>
        </svg>
        <span class="tab-label">Map</span>
      </button>
      <button class="tab" data-tab="nearby" aria-label="Nearby">
        <svg class="tab-icon" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"/>
          <circle cx="12" cy="10" r="3"/>
        </svg>
        <span class="tab-label">Nearby</span>
      </button>
      <button class="tab" data-tab="routes" aria-label="Routes">
        <svg class="tab-icon" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="6" cy="19" r="3"/><path d="M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15"/><circle cx="18" cy="5" r="3"/>
        </svg>
        <span class="tab-label">Routes</span>
      </button>
      <button class="tab" data-tab="gallery" aria-label="Gallery">
        <svg class="tab-icon" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <rect x="3" y="3" width="18" height="18" rx="2"/>
          <circle cx="9" cy="9" r="2"/>
          <path d="m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21"/>
        </svg>
        <span class="tab-label">Gallery</span>
      </button>
    </nav>

  </div>

  <!-- App modules -->
  <script type="module" src="js/app.js"></script>

  <script>
    // Register minimal SW (required for Chrome install prompt)
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('sw.js');
    }

    // Android/Chrome install prompt
    var deferredPrompt;
    var installPrompt = document.getElementById('install-prompt');
    window.addEventListener('beforeinstallprompt', function(e) {
      e.preventDefault();
      deferredPrompt = e;
      if (!localStorage.getItem('shine-installed')) {
        installPrompt.hidden = false;
      }
    });
    document.getElementById('install-accept').addEventListener('click', function() {
      if (!deferredPrompt) return;
      deferredPrompt.prompt();
      deferredPrompt.userChoice.then(function() {
        deferredPrompt = null;
        installPrompt.hidden = true;
        localStorage.setItem('shine-installed', '1');
      });
    });
    document.getElementById('install-dismiss').addEventListener('click', function() {
      installPrompt.hidden = true;
      localStorage.setItem('shine-installed', '1');
    });

    // iOS Safari install banner
    var isIOS = /iPhone|iPad|iPod/.test(navigator.userAgent);
    var isStandalone = window.navigator.standalone || window.matchMedia('(display-mode: standalone)').matches;
    if (isIOS && !isStandalone && !localStorage.getItem('shine-ios-dismiss')) {
      document.getElementById('ios-install').hidden = false;
    }
    document.getElementById('ios-dismiss').addEventListener('click', function() {
      document.getElementById('ios-install').hidden = true;
      localStorage.setItem('shine-ios-dismiss', '1');
    });
  </script>

</body>
</html>
